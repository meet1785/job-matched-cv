import{c as U,a as Z,r as h,j as e,P as X,b as D,C as $,d as E,e as I,f as O,B as M,u as ee,L as se,I as te,g as q}from"./index-0aOnIP42.js";import{preserveResumeFormat as re}from"./resumeParser-DvZf_pbG.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=U("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=U("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=U("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);var L="Progress",W=100,[ae,ve]=Z(L),[le,ce]=ae(L),H=h.forwardRef((s,r)=>{const{__scopeProgress:x,value:l=null,max:o,getValueLabel:P=me,...N}=s;(o||o===0)&&!G(o)&&console.error(de(`${o}`,"Progress"));const i=G(o)?o:W;l!==null&&!V(l,i)&&console.error(ue(`${l}`,"Progress"));const n=V(l,i)?l:null,f=R(n)?P(n,i):void 0;return e.jsx(le,{scope:x,value:n,max:i,children:e.jsx(X.div,{"aria-valuemax":i,"aria-valuemin":0,"aria-valuenow":R(n)?n:void 0,"aria-valuetext":f,role:"progressbar","data-state":K(n,i),"data-value":n??void 0,"data-max":i,...N,ref:r})})});H.displayName=L;var Y="ProgressIndicator",J=h.forwardRef((s,r)=>{const{__scopeProgress:x,...l}=s,o=ce(Y,x);return e.jsx(X.div,{"data-state":K(o.value,o.max),"data-value":o.value??void 0,"data-max":o.max,...l,ref:r})});J.displayName=Y;function me(s,r){return`${Math.round(s/r*100)}%`}function K(s,r){return s==null?"indeterminate":s===r?"complete":"loading"}function R(s){return typeof s=="number"}function G(s){return R(s)&&!isNaN(s)&&s>0}function V(s,r){return R(s)&&!isNaN(s)&&s<=r&&s>=0}function de(s,r){return`Invalid prop \`max\` of value \`${s}\` supplied to \`${r}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${W}\`.`}function ue(s,r){return`Invalid prop \`value\` of value \`${s}\` supplied to \`${r}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${W} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var Q=H,pe=J;const F=h.forwardRef(({className:s,value:r,...x},l)=>e.jsx(Q,{ref:l,className:D("relative h-4 w-full overflow-hidden rounded-full bg-secondary",s),...x,children:e.jsx(pe,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(r||0)}%)`}})}));F.displayName=Q.displayName;const he=({candidateData:s,jobData:r,isLoading:x})=>{const o=x?null:(()=>{var g,A;const i=s.skills.toLowerCase().split(/[,;\n]+/).map(t=>t.trim()).filter(Boolean),n=(((g=r.aiAnalysis)==null?void 0:g.keywords)||[]).map(t=>t.toLowerCase()),f=((A=r.aiAnalysis)==null?void 0:A.requirements)||[],y=n.filter(t=>i.some(m=>m.includes(t)||t.includes(m))),z=n.length?y.length/n.length*100:0,k=Math.round(Math.min(100,z)),d=[["summary",s.summary],["experience",s.experience],["skills",s.skills],["education",s.education]],T=d.filter(([t,m])=>m&&m.trim().length>30).length,j=Math.round(T/d.length*100),_=(s.experience.match(/\n?â€¢|^-|^\*/gm)||[]).length,S=s.experience.split(/\n+/).filter(t=>t.trim()).reduce((t,m)=>t+m.length,0)/Math.max(1,s.experience.split(/\n+/).filter(t=>t.trim()).length);let c=70;_>3&&(c+=10),S<180&&(c+=10),s.isFromUpload&&(c+=5),c=Math.min(100,c);const w=s.experience.split(/[.!?]+/).map(t=>t.trim()).filter(Boolean),C=w.reduce((t,m)=>t+m.split(/\s+/).filter(Boolean).length,0)/Math.max(1,w.length),u=["led","managed","developed","built","improved","optimized","designed","implemented","collaborated","created","reduced","increased","delivered"],v=s.experience.toLowerCase().split(/\b/).filter(t=>u.includes(t.trim())).length;let a=70;C>=10&&C<=25?a+=15:a-=10,v>=Math.max(3,w.length*.3)?a+=10:a-=5,s.experience.length>400&&(a+=5),a=Math.max(30,Math.min(100,a));const b=Math.round(k*.35+j*.2+c*.2+a*.25),p=t=>t>=80?"good":t>=60?"warning":"poor";return{overall:b,categories:{keywords:{score:k,status:p(k),details:[`${y.length}/${n.length||0} job keywords matched`,n.length?`Top missing: ${n.filter(t=>!y.includes(t)).slice(0,5).join(", ")||"None"}`:"No job keywords provided",`Skills list size: ${i.length}`]},formatting:{score:c,status:p(c),details:[`Bullet points detected: ${_}`,`Avg line length: ${Math.round(S)} chars`,s.isFromUpload?"Original structure preserved":"Manual entry structure"]},sections:{score:j,status:p(j),details:[`Sections present: ${T}/${d.length}`,d.filter(([t,m])=>!m||m.trim().length<=30).length?"Consider expanding missing/short sections":"All essential sections filled",f.length?`${f.length} job requirements analyzed`:"No job requirements extracted"]},readability:{score:a,status:p(a),details:[`Avg words per sentence: ${Math.round(C)}`,`Action verbs used: ${v}`,s.experience.length>1500?"Consider shortening very long experience section":"Experience length reasonable"]}}}})(),P=i=>{switch(i){case"good":return e.jsx(oe,{className:"w-5 h-5 text-success"});case"warning":return e.jsx(ie,{className:"w-5 h-5 text-warning"});case"poor":return e.jsx(ne,{className:"w-5 h-5 text-destructive"})}},N=i=>i>=80?"text-success":i>=60?"text-warning":"text-destructive";return x?e.jsxs($,{className:"shadow-card",children:[e.jsx(E,{children:e.jsx(I,{className:"text-xl",children:"ATS Compatibility Analysis"})}),e.jsx(O,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-sm font-medium",children:"Analyzing ATS compatibility..."}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Checking formatting, keywords, and structure"})]})})]}):o?e.jsxs($,{className:"shadow-card",children:[e.jsxs(E,{children:[e.jsxs(I,{className:"text-xl flex items-center gap-3",children:["ATS Compatibility Score",e.jsxs(M,{variant:o.overall>=80?"default":o.overall>=60?"secondary":"destructive",className:"text-lg px-3 py-1",children:[o.overall,"%"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(F,{value:o.overall,className:"h-3"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:o.overall>=80?"Excellent! Your resume is highly optimized for ATS systems.":o.overall>=60?"Good score with room for improvement.":"Needs improvement to pass ATS filters effectively."})]})]}),e.jsx(O,{children:e.jsxs("div",{className:"space-y-6",children:[Object.entries(o.categories).map(([i,n])=>e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[P(n.status),e.jsx("h3",{className:"text-sm font-semibold capitalize",children:i})]}),e.jsxs("span",{className:`text-sm font-semibold ${N(n.score)}`,children:[n.score,"%"]})]}),e.jsx(F,{value:n.score,className:"h-2"}),e.jsx("div",{className:"space-y-1",children:n.details.map((f,y)=>e.jsxs("p",{className:"text-xs text-muted-foreground flex items-start gap-1",children:[e.jsx("span",{className:"text-primary",children:"â€¢"}),f]},y))})]},i)),e.jsxs("div",{className:"mt-6 p-4 bg-accent/10 rounded-lg border",children:[e.jsx("h4",{className:"text-sm font-semibold mb-2",children:"ðŸ’¡ ATS Optimization Tips"}),e.jsxs("ul",{className:"text-xs text-muted-foreground space-y-1",children:[e.jsx("li",{children:"â€¢ Use standard section headers (Experience, Education, Skills)"}),e.jsx("li",{children:"â€¢ Include relevant keywords from the job description"}),e.jsx("li",{children:"â€¢ Avoid complex formatting, tables, or graphics"}),e.jsx("li",{children:"â€¢ Use common file formats (PDF or DOCX)"}),e.jsx("li",{children:"â€¢ Quantify achievements with specific numbers and metrics"})]})]})]})})]}):null},xe="https://hook.eu2.make.com/vccbm0b5e6zb6nk5475i4akaguoki15q",ye=({candidateData:s,jobData:r,onComplete:x})=>{const[l,o]=h.useState(xe),[P,N]=h.useState(!1),[i,n]=h.useState(!1),[f,y]=h.useState(0),[z,k]=h.useState([]),[d,T]=h.useState(null),[j,_]=h.useState(null),[S,c]=h.useState(!1),{toast:w}=ee(),B=()=>{const u=["Analyzing job requirements...","Optimizing candidate profile...","Generating ATS-friendly format...","Creating professional summary...","Optimizing work experience...","Organizing skills and keywords...","Generating HTML template...","Converting to PDF format...","Running ATS compatibility check...","Finalizing resume..."];k([]),y(0),u.forEach((v,a)=>{setTimeout(()=>{if(k(b=>[...b,v]),y((a+1)/u.length*100),a===u.length-1){const b=()=>{N(!1),n(!0),w({title:"Resume Generated Successfully!",description:"Review automation output and ATS score below."})},p=Date.now(),g=setInterval(()=>{const A=Date.now()-p>2e4;(!S||d||j||A)&&(clearInterval(g),b())},400)}},a*800)})},C=async u=>{var v;if(u.preventDefault(),!l){w({title:"Error",description:"Please enter your Make.com webhook URL",variant:"destructive"});return}N(!0),B();try{const a=s.isFromUpload&&s.originalFormat?re(s.originalFormat,s):s,b={timestamp:new Date().toISOString(),candidate:a,jobDescription:r,automation_trigger:"resume_generation",source:s.isFromUpload?"uploaded_resume":"manual_input",options:{format:["pdf","docx","html"],ats_optimization:!0,keyword_optimization:!0,professional_formatting:!0,preserve_original_format:s.isFromUpload||!1,format_instructions:s.originalFormat||null},processing_instructions:{maintain_structure:s.isFromUpload,optimize_for_ats:!0,keyword_density_target:"2-3%",sections_to_optimize:["summary","experience","skills"],output_formats:{primary:((v=s.originalFormat)==null?void 0:v.fileType)||"pdf",secondary:["html","docx"]}}};console.log("Sending enhanced payload to Make.com:",b),c(!0);const p=await fetch(l,{method:"POST",headers:{"Content-Type":"application/json","X-Resume-Source":s.isFromUpload?"upload":"manual","X-Preserve-Format":s.isFromUpload?"true":"false"},body:JSON.stringify(b)});let g=null;if((p.headers.get("content-type")||"").includes("application/json"))try{g=await p.json()}catch{}if(!g)try{g=await p.text()}catch{}T(g||{status:p.status,message:"No content"}),c(!1),console.log("Make.com webhook responded:",g)}catch(a){console.error("Error triggering Make.com webhook:",a),_((a==null?void 0:a.message)||"Webhook request failed"),c(!1),N(!1),w({title:"Error",description:"Failed to trigger the Make.com webhook. Please check your URL and try again.",variant:"destructive"})}};return e.jsxs($,{className:"shadow-card",children:[e.jsxs(E,{children:[e.jsx(I,{className:"text-2xl bg-gradient-primary bg-clip-text text-transparent",children:"Make.com Integration"}),e.jsx("p",{className:"text-muted-foreground",children:"Connect to your Make.com automation to generate and deliver your optimized resume"})]}),e.jsx(O,{children:!P&&!i?e.jsxs("form",{onSubmit:C,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(se,{htmlFor:"webhookUrl",children:"Make.com Webhook URL *"}),e.jsx(te,{id:"webhookUrl",type:"url",placeholder:"https://hooks.make.com/your-webhook-url",value:l,onChange:u=>o(u.target.value)}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Using default permanent webhook unless you replace it"})]}),e.jsxs("div",{className:"bg-accent/10 p-4 rounded-lg border",children:[e.jsx("h3",{className:"font-semibold mb-3",children:"What will be sent to Make.com:"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{variant:"secondary",children:"Candidate Data"}),e.jsx("span",{className:"text-sm",children:(s==null?void 0:s.fullName)||"Your profile"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{variant:"secondary",children:"Job Description"}),e.jsx("span",{className:"text-sm",children:(r==null?void 0:r.jobTitle)||"Target position"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{variant:"secondary",children:"AI Analysis"}),e.jsx("span",{className:"text-sm",children:"Keywords and optimization data"})]}),(s==null?void 0:s.isFromUpload)&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{variant:"outline",children:"Format Preservation"}),e.jsx("span",{className:"text-sm",children:"Original format will be maintained"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{variant:"outline",children:"Output Formats"}),e.jsx("span",{className:"text-sm",children:"PDF, DOCX, HTML"})]})]})]}),e.jsx(q,{type:"submit",className:"w-full bg-gradient-primary hover:shadow-elegant transition-all duration-300 text-lg py-6",children:"Generate Resume with Make.com"})]}):i?e.jsxs("div",{className:"space-y-6",children:[e.jsx(he,{candidateData:s,jobData:r,isLoading:!1}),e.jsxs("div",{className:"p-4 bg-accent/10 rounded-lg border space-y-3",children:[e.jsx("h3",{className:"text-sm font-semibold",children:"Automation Output"}),S&&e.jsx("p",{className:"text-xs text-muted-foreground",children:"Waiting for webhook response..."}),j&&e.jsxs("p",{className:"text-xs text-destructive",children:["Webhook Error: ",j]}),d&&e.jsx("pre",{className:"text-xs whitespace-pre-wrap max-h-60 overflow-y-auto bg-background p-3 rounded border",children:typeof d=="string"?d.slice(0,5e3):JSON.stringify(d,null,2).slice(0,5e3)}),!d&&!j&&!S&&e.jsx("p",{className:"text-xs text-muted-foreground",children:"No response captured (CORS or scenario not returning data). The automation may still have processed your payload."})]}),e.jsx("div",{className:"text-center",children:e.jsx(q,{onClick:x,className:"bg-gradient-primary hover:shadow-elegant transition-all duration-300 text-lg py-6 px-8",children:"Complete Resume Generation"})})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Processing Your Resume"}),e.jsx("p",{className:"text-muted-foreground",children:"Your resume is being generated using our 20-module automation"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(F,{value:f,className:"w-full"}),e.jsxs("div",{className:"text-center text-sm font-medium",children:[Math.round(f),"% Complete"]})]}),e.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:z.map((u,v)=>e.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[e.jsx("div",{className:"w-2 h-2 bg-accent rounded-full flex-shrink-0"}),e.jsx("span",{className:"text-muted-foreground",children:u})]},v))})]})})]})};export{ye as MakeIntegration};
